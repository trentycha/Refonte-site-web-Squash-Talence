{% extends 'base.html.twig' %}

{% block title %}Calendrier des réservations{% endblock %}

{% block body %}
<h1 style="font-size:35px;text-align:center;margin-bottom:20px;margin-top:120px;">Calendrier des Réservations</h1>

<div class="day-navigation">
    <a href="{{ path('app_calendrier_reservations', { day: previousDay|date('Y-m-d') }) }}" class="btn btn-secondary">← Journée précédente</a>
    <span class="current-day">Journée du {{ startOfDay|date('d/m/Y') }}</span>
    <a href="{{ path('app_calendrier_reservations', { day: nextDay|date('Y-m-d') }) }}" class="btn btn-secondary">Journée suivante →</a>
</div>

<style>
.day-navigation {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin: 0 auto 30px auto;
    background: #ffffff;
    padding: 15px 25px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    font-weight: 600;
    max-width: 1200px; 
}

.day-navigation a {
    text-decoration: none;
    color: #fff;
    background: #ffce2eff;
    padding: 8px 16px;
    border-radius: 6px;
    transition: background 0.2s;
}

.day-navigation a:hover {
    background: #440c30ff;
}

.current-day {
    font-size: 1.1rem;
    color: #670537ff;
}

.calendar {
    display: grid;
    grid-template-columns: 80px repeat(7, 1fr);
    grid-auto-rows: 60px;
    gap: 4px;
    background: white;
    padding: 50px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    margin: 0px auto;
    max-width: 1200px;
}

.corner {
    background: #ffffff;
    color: white;
    font-weight: bold;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 6px;
}

.day-header {
    background: #670537ff;
    color: white;
    font-weight: 600;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 6px;
}

.hour {
    background: #ffffffff;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 6px;
    font-weight: 500;
    border: 1px solid #e2e8f0;
}

.slot {
    background: white;
    border: 1px dashed #d1d5db;
    border-radius: 6px;
    transition: background 0.2s, transform 0.1s;
    cursor: pointer;
}

.slot:hover {
    background: #440c30ff;
    transform: scale(1.02);
}

.slot.reserved {
    background: #670537ff !important;
    color: white !important;
    border: none;
    cursor: not-allowed !important;
}
</style>

<div class="calendar">
    <div class="corner"></div>
    {% for terrain in 1..7 %}
        <div class="day-header">Terrain {{ terrain }}</div>
    {% endfor %}

    {% set heures = ['10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00'] %}

    {% for h in heures %}
    <div class="hour">{{ h }}</div>
        {% for terrain in 1..7 %}
            {% set key = startOfDay|date('Y-m-d') ~ ' ' ~ h ~ '_terrain_' ~ terrain %}

                {% if key in reservationsByDatetime %}
                    <div class="slot reserved" title="Réservé par {{ reservationsByDatetime[key].getUser().getUsername() }}">
                        {{ reservationsByDatetime[key].getUser().getUsername() }}
                    </div>
                {% else %}
                    <a href="{{ path('resa_calendrier', { date: startOfDay|date('Y-m-d') ~ ' ' ~ h, terrain: terrain }) }}" class="slot" title="Réserver ce créneau"></a>
                {% endif %}

        {% endfor %}
    {% endfor %}

</div>
{% endblock %}
